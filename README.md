# XDMapReduce
西电分布式计算mapreduce实验
## 实验内容
输入文件为学生成绩信息，包含了必修课与选修课成绩，格式如下：
班级1, 姓名1, 科目1, 必修, 成绩1 <br> （注：<br> 为换行符）
班级2, 姓名2, 科目1, 必修, 成绩2 <br>
班级1, 姓名1, 科目2, 选修，成绩3 <br>
………., ………, ………, ………   <br>
编写两个Hadoop平台上的MapReduce程序，分别实现如下功能：
1. 计算每个学生必修课的平均成绩。
2. 按科目统计每个班的平均成绩。
题目2
输入文件的每一行为具有父子/父女/母子/母女/关系的一对人名，例如：
Tim, Andy <br>
Harry, Alice <br>
Mark, Louis <br>
Andy, Joseph <br>
……….., ………… <br>
假定不会出现重名现象。
编写Hadoop平台上的MapReduce程序，找出所有具有grandchild-grandparent关系的人名组。
## 实验环境
- docker中Hadoop环境(单节点)
## Q1.1 计算每个学生必修课的平均成绩
- Map阶段，对输入文件行进行分割，分隔符为“，”,Map阶段输出<姓名,必修课成绩>的键值对，其中对课程类型做判断，不保留选修课成绩。
- Reduce阶段，输入数据为经过聚合的<姓名,[必修成绩1,必修成绩2,...]>，计算平均成绩，只需要遍历输入键值对value列表计算即可。
## Q1.2 按科目计算每个班级的平均成绩
- Map阶段，同上一个任务一样，分割输入每行数据，使得Map阶段输出键值对为<(科目,班级),成绩>
- Reduce阶段处理聚合后Mapper类输出的数据，输入Reducer类的键值对为<(班级,科目)，[成绩1，成绩2，.....]>只需遍历values累加求平均即可。
## Q2 找出祖孙关系
- 给定亲子关系要求找出祖孙关系,这就要求key作为中间代来连接祖孙，使Mapper类输出的结果为<key,[grandchild,grandparent]>，那么value中的元素就是一对或多对祖孙关系，关键是要将输入行反序再读出，为了标识value中祖孙元素，读入时我添加了字符串开头"p:""c:"那么在遍历时就可以使用startwith函数来发现是祖辈还是孙辈
- map 正序和反序输出键值对\<child,p:parent>,\<parent,c:child>
- reduce 建立两个列表，分别存放value中祖辈和孙辈，最后输出它们的笛卡尔积。
> Q2似乎因为测试文件问题，若不使用trim输出会缺少4个;
> 该仓库只存放了源码文件,无maven项目`pom.xml`
